% ******* Start of file osabib.sty *******
%
% Copyright (c) 1992, Optical Society of America.
%
%   This is one of the files of the release version of the OSA macros for
% REVTEX 3.0. REVTEX 3.0 is being developed by cooperation between the AAS,
% AGU, AIP, APS, and OSA.
%
%
% Support is available weekdays, 8:45 am--4:30 pm, East coast(USA) time.
%
%     Frank Harris
%     Optical Society of America
%     2010 Massachusetts Ave. N.W.
%     Washington D.C. 20036-1023
%     (202) 416-1903 (phone)
%     (202) 416-6120 (fax)
%     fharris@aip.org (Internet)
%
%
%

\typeout{Filename: mybib.sty modifyed from osabib.sty by A. Sazontov}
\typeout{Filename: mybib.sty modifyed a bit by A. Lebedev 28 Nov. 2001}

\def\@bibitem#1{\item\if@filesw \immediate\write\@auxout
       {\string\bibcite{#1}{\the\value{\@listctr}}}\fi\ignorespaces}

\def\@cite#1#2{{[#1\if@tempswa , #2\fi]}}  %
%%\def\@biblabel#1{${#1.\,\,\,}$} % commented by Lebedev for the reason
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% explained below (@citex definition)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% number of spaces is decreased.
\def\@biblabel#1{{#1.\,}} %

\newdimen\WidestRefLabelThusFar
\global\WidestRefLabelThusFar\z@

\def\bibcite#1#2{\global\@namedef{b@#1}{#2}\@SetMaxRefLabel{#1}}

\def\@SetMaxRefLabel#1{%
  {%
    \setbox0\hbox{${\csname b@#1\endcsname}.\,\,\,$}%
    \ifdim\wd0>\WidestRefLabelThusFar
      \global\WidestRefLabelThusFar=\wd0
    \fi
  }%
}

\def\@citex[#1]#2{%
\if@filesw\immediate\write\@auxout{\string\citation{#2}}\fi
%% \leavevmode\unskip$~{\@cite{\@collapse{#2}}{#1}}$} % commented by Lebedev 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% to use fonts differed
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% from Comp.Modern
\leavevmode\unskip~{\@cite{\@collapse{#2}}{#1}}}

\def\CITE{%
\@ifnextchar[{\@tempswatrue\@CITEX}{\@tempswafalse\@CITEX[]}%
}

\let\onlinecite\CITE

\def\@CITEX[#1]#2{%
\if@filesw\immediate\write\@auxout{\string\citation{#2}}\fi
\leavevmode\unskip\ \@cite{\@collapse{#2}}{#1}}

\let\bylinecite\cite

\def\@collapse#1{%
 {%
  \let\@temp\relax
  \@tempcntb\@MM
  \def\@citea{}%
  \@for \@citeb:=#1\do{%
    \@ifundefined{b@\@citeb}%
      {\@temp\@citea{\bf ?}%
       \@tempcntb\@MM\let\@temp\relax
       \@warning{Citation `\@citeb ' on page \thepage\space undefined}%
      }%
      {\@tempcnta\@tempcntb \advance\@tempcnta\@ne
       \edef\MyTemp{\csname b@\@citeb\endcsname}%
       \def\@tempa{\@temptokena=\bgroup}%
       \if0A{\fi%
       \afterassignment\@tempa %
       \@tempcntb=0\MyTemp\relax}%
       \ifnum\@tempcntb=0\relax%
         \@tempcntb=\@MM
         \@citea\MyTemp
         \let\@temp = \relax
       \else %
         \edef\@tempd{\number\@tempcntb}%
         \ifnum\@tempcnta=\@tempcntb %
            \ifx\@temp\relax %
               \edef\@temp{\@citea\@tempd}%
            \else
               \edef\@temp{\hbox{--}\@tempd}%
            \fi
         \else %
           \@temp\@citea\@tempd
           \let\@temp\relax
         \fi
       \fi
      }%
    \def\@citea{, }%
  }%
  \@temp %
 }%
}%
\endinput %<------- !!!
\def\references{%
  \ifpreprintsty
    \newpage
    \hbox to\hsize{\refname\hss}%
  \else
    \vskip24pt
    \hrule width\textwidth\relax
    \vskip 1.6cm
  \fi
  \list{\@biblabel{\arabic{enumiv}}}%
       {\labelwidth\WidestRefLabelThusFar  \labelsep2pt %
        \leftmargin\labelwidth
        \advance\leftmargin\labelsep
        \ifdim\baselinestretch pt>1 pt  %
          \parsep  4pt\relax
        \else
          \parsep  0pt\relax
        \fi
        \itemsep\parsep
        \usecounter{enumiv}%
        \let\p@enumiv\@empty
        \def\theenumiv{\arabic{enumiv}}%
       }%
  \let\newblock\relax
  \sloppy\clubpenalty4000\widowpenalty4000
  \sfcode`\.=1000\relax
  \ifpreprintsty\else\small\fi
}

\def\endreferences{%
  \def\@noitemerr{\@warning{Empty `thebibliography' environment}}%
  \endlist     \let\@SetMaxRefLabel\@gobble
}

\def\thebibliography#1{\references}

\def\endthebibliography{\endreferences}

%
% ****** End of file osabib.sty ******

